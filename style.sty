% !TeX root = ./main.tex
%
% LaTeX Style document: contains definitions and descriptions of the specific styling attriutes used 
% to format the document.
%
% More details about formatting and using the following packages can be found in ./notes/notes.md 
% where some notes in random order have been collected.
%
% ---------------------------------------------------------------------------------------------------
% PACKAGES
% ---------------------------------------------------------------------------------------------------
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{newlfont}
\usepackage{geometry}   			% to customize page layout
\usepackage{changepage}       % for adjustwidth environment
\usepackage{caption}          % to customize captions
\usepackage{amsmath}    			% math equations: use `begin{equation[*]}`
\usepackage{amssymb}				  % math symbols
\usepackage{mdframed}   			% to create framed boxes (used for syntax blocks)
\usepackage{hyperref}  				% [hidelinks] = hide a box around active links
% to reference in latex @see https://texblog.org/2013/05/06/cleveref-a-clever-way-to-reference-in-latex/
\usepackage{cleveref}
% \usepackage[disable]{todonotes} 	% to uncomment before final version
\usepackage{todonotes}            	% to comment before final version
% bibliography: @see https://it.overleaf.com/learn/latex/Biblatex_citation_styles
\usepackage[
    backend=biber,
    % for more on styles: @see https://it.overleaf.com/learn/latex/Biblatex_bibliography_styles
    style=alphabetic,
]{biblatex}
\usepackage{xcolor}					% to define colors
\usepackage{csquotes}				% to inline and display quotations
\usepackage{enumitem}           	% to manage items spacing in `itemize`
\setlist{itemsep=3pt, topsep=4pt, parsep=2pt} % reduces spacing in itemize, enumerate, description
\usepackage{listings}           	% for code listings - see the listing configs section below
\usepackage{multicol}				% for multicolumns
\usepackage{multirow}				% for tables with rows spanning in more lines
\usepackage{tabularx}				% for tables with adjustable-width columns
\usepackage{makecell}				% for line breaks in table cells
\usepackage{booktabs}				% for better looking tables
\usepackage{diagbox}				% for tables diagonal box
\usepackage{rotating}				% for images in landscape
% TeX break lines at spaces (and a few other positions in a word, called "discretionary break"). 
% Discretionary break is not allowed in typewriter typesetting. 
% If there is no space in \texttt{}, it cannot break.
% To avoid this problem is necessary to enable hythenation of TT text:
\usepackage[htt]{hyphenat}		
\usepackage{pgfplots}				% for graphs 
\pgfplotsset{compat = newest}
% Using the openright option it is possible to have a blank page at the finish of the chapter; 
% to avoid having headers or footers, it is sufficient to add the following commands in the preamble.
\makeatletter
\def\cleardoublepage{
	\clearpage
	\if @twoside
		\if odd \c@page
		\else 
			\hbox{}
			\thispagestyle{empty}
			\newpage
		\fi
	\fi
	\if @twocolumn 
		\hbox{} \newpage
	\fi
}
\makeatother
% spacing between lines
\usepackage{setspace}
\def\themainlinespacing{1}
\newcommand{\mainlinespacing}[1]{\def\themainlinespacing{#1}}
\let\oldmainmatter\mainmatter
\renewcommand{\mainmatter}{
    \oldmainmatter
    % \onehalfspacing % https://tex.stackexchange.com/questions/30073/why-is-the-linespread-factor-as-it-is
    \setstretch{\themainlinespacing}
}

% ---------------------------------------------------------------------------------------------------
% ENVIRONMENTS
% ---------------------------------------------------------------------------------------------------
% Right after the \newenvironment, in between braces, you must write the name of the environment.
% Below that are two pairs of braces. Inside the first pair of braces is set what your new environment 
% will do before the text within, then inside the second pair of braces declare what your new environment 
% will do after the text.
\newenvironment{abstract}{
    \chapter*{\centering\abstractname}
    \addcontentsline{toc}{chapter}{\abstractname}
}{} 

\newenvironment{dedication}{
    \chapter*{}
    \begin{flushright}
        \null\vspace{\stretch{1}}
        \itshape
}{
        \normalfont
        \vspace{\stretch{2}}\null
    \end{flushright}
}

\newmdenv[
  skipabove=0pt,
  skipbelow=0pt,
  linewidth=0pt,
  innerleftmargin=1em,
  innerrightmargin=1em,
  innertopmargin=0.3ex,
  innerbottommargin=0.3ex
]{syntaxblock}

\newenvironment{syntax}{
  \begin{center}
  \vspace{-0.5\baselineskip} % tighten space above (optional)
  \begin{syntaxblock}
  \vspace{-0.3\baselineskip} % tighten internal spacing before math
  \[
  \setlength{\arraycolsep}{3pt} % tighter column spacing if desired
  \begin{array}{rcl}
}{
  \end{array}
  \]
  \vspace{-0.5\baselineskip} % tighten after display math
  \end{syntaxblock}
  \vspace{-1.5\baselineskip} % tighten below
  \end{center}
}

% ---------------------------------------------------------------------------------------------------
% LISTING CONFIGURATIONS
% See https://en.wikibooks.org/wiki/LaTeX/Source_Code_Listings
% ---------------------------------------------------------------------------------------------------
%\renewcommand{\lstlistingname}{Listato}
% By default, cleveref doesnâ€™t know how to format references to lstlisting environments and prints `??` when you try to reference them.
\crefname{lstlisting}{\lstlistingname}{listing}
\Crefname{lstlisting}{\lstlistingname}{Listing}

\lstset{
	showstringspaces=false,
	basicstyle=\footnotesize\ttfamily,
	commentstyle={\color{olive}},
	identifierstyle=\color{black},
	ndkeywordstyle={\color{blue}},
	stringstyle={\color{magenta}},
	emphstyle={},
	keywordstyle={\color{blue}},
	breaklines=true,
	numbers=left,
	numberstyle=\tiny\color{gray},
	numbersep=10pt,
	tabsize=2,
	extendedchars=true,
	frame=trBL,
	frameround=fttt,
}

% defining style for not yet supported languages:
\lstdefinelanguage{Kotlin} {
	comment=[l]{//},
	emph={delegate, filter, first, firstOrNull, forEach, lazy, map, mapNotNull, println, return@},
	keywords={abstract, actual, as, as?, break, by, class, companion, continue, data, do, dynamic, else, enum, expect, false, final, for, fun, get, if, import, in, interface, internal, is, null, object, override, package, private, public, return, set, super, suspend, this, throw, true, try, typealias, val, var, vararg, when, where, while},
	morecomment=[s]{/*}{*/},
	morestring=[b]",
	morestring=[s]{"""*}{*"""},
	ndkeywords={@Deprecated, @JvmField, @JvmName, @JvmOverloads, @JvmStatic, @JvmSynthetic, Array, Byte, Double, Float, Int, Integer, Iterable, Long, Runnable, Short, String, Unit, it},
	sensitive=true
}

\lstdefinelanguage{pseudocode} {
	sensitive=false,
	keywords={while, do, endwhile, if, then, else, endif, repeat, until, for, endfor, from, to, each, step, function, procedure, begin, end, return, input, output, data, result, type, object, class, array, integer, boolean, true, false, real, string}, 
	comment=[l]{//},
	morecomment=[s]{/*}{*/},
	string=[b]{"},
	mathescape=true,
	literate={:=}{{$\gets$ }}1 {<-}{{$\gets$ }}1 {<=}{{$\leq$ }}1 {>=}{{$\geq$ }}1 {<>}{{$\neq$ }}1 {!=}{{$\neq$ }}1
}

\lstdefinelanguage{yaml} {
	keywords={true,false,null,y,n},
	sensitive=false,
	comment=[l]{\#},
	morecomment=[s]{/*}{*/},
	stringstyle=\color{blue}\mdseries\ttfamily,
	moredelim=[l][\color{orange}]{\&},
	moredelim=[l][\color{magenta}]{*},
	morestring=[b]',
	morestring=[b]",
	moredelim=**[il][\color{magenta}\mdseries{:}\color{blue}\mdseries]{:},
	literate={>}{{\textcolor{magenta}\textgreater}}1
			 {|}{{\textcolor{magenta}\textbar}}1
			 {\ -\ }{{\mdseries\ -\ }}3,
}

% ---------------------------------------------------------------------------------------------------
% CHAPTER STYLE
% ---------------------------------------------------------------------------------------------------

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{simplechapstyle}[2025/09/03 Minimal elegant chapter style]

\RequirePackage{titlesec}
\RequirePackage{xcolor}

\definecolor{chaptergray}{RGB}{120,120,120}   % Gray color
\newlength{\chapnumwidth}                     % Width reserved for chapter number
\setlength{\chapnumwidth}{3em}

% Chapter number font (scaled Palatino oldstyle figures)
\newfont{\chapterNumber}{pplr9d scaled 7000}

% Define a small vertical rule element
\newcommand{\chapdivider}{%
  \color{chaptergray}%
  \rule[-0.4ex]{0.4pt}{1.5em} % thin, slightly taller than number baseline
}

% Chapter formatting: number, divider, then title
\titleformat{\chapter}[hang]
  {\normalfont\Huge\bfseries}
  {\makebox[\chapnumwidth][r]{\chapterNumber\thechapter}\hspace{0.75em}\chapdivider}
  {0.5em} % space between divider and title
  {} 

% Vertical spacing: before chapter, after title
\titlespacing*{\chapter}{0pt}{35pt}{30pt}

% Optional: section spacing inside chapters
\titlespacing*{\section}{0pt}{24pt}{12pt}

% --- Chapter and Section headers in the header/footer ---
\usepackage{fancyhdr}
\pagestyle{fancy}

% Normal pages (not chapter starts)
\fancypagestyle{fancy}{
    \fancyhf{}
    % Header: section name
    \fancyhead[CE,CO]{\rightmark}
    % Footer: chapter name and page number
    \fancyfoot[RE,LO]{\leftmark}
    \fancyfoot[LE,RO]{\thepage}
    % Horizontal rules
    \renewcommand{\headrulewidth}{0pt}   % remove top line
    \renewcommand{\footrulewidth}{0.1pt} % thin bottom line
}

% Chapter-opening pages
\fancypagestyle{plain}{
    \fancyhf{}
    % Header: section name still present
    \fancyhead[CE,CO]{\rightmark}
    % Footer: chapter name and page number, thin line
    \fancyfoot[RE,LO]{\leftmark}
    \fancyfoot[LE,RO]{\thepage}
    \renewcommand{\headrulewidth}{0pt}   % no top line
    \renewcommand{\footrulewidth}{0.1pt} % thin bottom line
}

\pagestyle{fancy}

% Ensure enough head height for header content
\setlength{\headheight}{14.5pt}

% Proper marks for chapter/section titles
\renewcommand{\chaptermark}[1]{\markboth{Chapter \thechapter.\ #1}{}} 
\renewcommand{\sectionmark}[1]{\markright{\thesection.\ #1}}
